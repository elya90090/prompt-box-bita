<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø¯Ù…ÛŒÙ† Ø¬Ø¹Ø¨Ù‡ Ù¾Ø±Ø§Ù…Ù¾Øª Ø¨ÛŒØªØ§</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.10.0/dist/supabase.min.js"></script>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; padding:20px; }
.container { max-width:600px; margin:auto; }
h2 { text-align:center; margin-bottom:20px; }
footer { text-align:center; margin-top:30px; }
</style>
</head>
<body>

<div class="container">
  <h2>ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†</h2>
  <input type="text" id="username" class="form-control mb-2" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ">
  <input type="password" id="password" class="form-control mb-2" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
  <button class="btn btn-primary w-100 mb-3" onclick="login()">ÙˆØ±ÙˆØ¯</button>

  <div id="adminPanel" style="display:none;">
    <h3>Ø«Ø¨Øª Ù¾Ø±Ø§Ù…Ù¾Øª Ø¬Ø¯ÛŒØ¯</h3>
    <input type="text" id="name" class="form-control mb-2" placeholder="Ù†Ø§Ù… Ù¾Ø±Ø§Ù…Ù¾Øª">
    <textarea id="text" class="form-control mb-2" placeholder="Ù…ØªÙ† Ù¾Ø±Ø§Ù…Ù¾Øª"></textarea>
    <input type="text" id="source" class="form-control mb-2" placeholder="Ù…Ù†Ø¨Ø¹">
    <input type="text" id="category" class="form-control mb-2" placeholder="Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ">
    <input type="text" id="description" class="form-control mb-2" placeholder="Ø´Ø±Ø­">
    <button class="btn btn-success w-100" onclick="addPrompt()">Ø«Ø¨Øª</button>
  </div>
</div>

<footer>
  Ø·Ø±Ø§Ø­ÛŒ Ùˆ ØªÙˆØ³Ø¹Ù‡ Ø¯Ù‡Ù†Ø¯Ù‡ @raz3400
</footer>

<script>
// Ø§ØªØµØ§Ù„ Ø¨Ù‡ Supabase
const supabaseUrl = 'YOUR_SUPABASE_URL';             // â† Ø¢Ø¯Ø±Ø³ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒØ§Øª Ø¯Ø± Supabase
const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';        // â† Ú©Ù„ÛŒØ¯ anon Ù¾Ø±ÙˆÚ˜Ù‡â€ŒØ§Øª
const supabase = supabase.createClient(supabaseUrl, supabaseKey);

// Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…
const TELEGRAM_BOT_TOKEN = 'YOUR_TELEGRAM_BOT_TOKEN';  // â† ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª
const TELEGRAM_CHAT_ID = 'YOUR_SUPERGROUP_CHAT_ID';    // â† Ø¢ÛŒØ¯ÛŒ Ø³ÙˆÙ¾Ø±Ú¯Ø±ÙˆÙ‡ (Ù…Ø«Ø§Ù„: -100123456789)
const TELEGRAM_TOPIC_ID = 'YOUR_TOPIC_ID';             // â† Ø¢ÛŒØ¯ÛŒ ØªØ§Ù¾ÛŒÚ© (Ù…Ø«Ø§Ù„: 34547)

// ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†
async function login(){
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();

  const { data, error } = await supabase
    .from('admins')
    .select('*')
    .eq('username', username)
    .eq('password', password);

  if(error || !data || data.length === 0){
    alert('Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª âŒ');
    return;
  }

  document.getElementById('adminPanel').style.display = 'block';
  alert('ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚ âœ…');
}

// Ø§ÙØ²ÙˆØ¯Ù† Ù¾Ø±Ø§Ù…Ù¾Øª
async function addPrompt(){
  const name = document.getElementById('name').value;
  const text = document.getElementById('text').value;
  const source = document.getElementById('source').value;
  const category = document.getElementById('category').value;
  const description = document.getElementById('description').value;

  const date = new Date();
  const iranOffset = 4.5 * 60;
  const localDate = new Date(date.getTime() + iranOffset*60000);
  const dateShamsi = localDate.toLocaleDateString('fa-IR');
  const time = localDate.toLocaleTimeString('fa-IR');
  const trackingCode = 'P' + Date.now();

  const { error } = await supabase.from('prompts').insert([{
    name, text, source, category, description, dateShamsi, time, trackingCode
  }]);

  if(error){ 
    alert('Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª: ' + error.message); 
    return; 
  }

  const message = `ğŸ“ Ù¾Ø±Ø§Ù…Ù¾Øª Ø¬Ø¯ÛŒØ¯ Ø«Ø¨Øª Ø´Ø¯\n\n` +
  `ğŸ“Œ Ù†Ø§Ù… Ù¾Ø±Ø§Ù…Ù¾Øª: ${name}\n` +
  `ğŸ’¬ Ù…ØªÙ† Ù¾Ø±Ø§Ù…Ù¾Øª: ${text}\n` +
  `ğŸ”— Ù…Ù†Ø¨Ø¹: ${source}\n` +
  `ğŸ“‚ Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ: ${category}\n` +
  `ğŸ“ Ø´Ø±Ø­: ${description}\n` +
  `ğŸ“… ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª: ${dateShamsi}\n` +
  `â° Ø³Ø§Ø¹Øª Ø«Ø¨Øª: ${time}\n` +
  `ğŸ”‘ Ú©Ø¯ Ø±Ù‡Ú¯ÛŒØ±ÛŒ: ${trackingCode}`;

  // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ø³ÙˆÙ¾Ø±Ú¯Ø±ÙˆÙ‡ + ØªØ§Ù¾ÛŒÚ©
  fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      chat_id: TELEGRAM_CHAT_ID,
      message_thread_id: TELEGRAM_TOPIC_ID,
      text: message
    })
  })
    .then(() => alert('Ø«Ø¨Øª Ø´Ø¯ Ùˆ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ø³ÙˆÙ¾Ø±Ú¯Ø±ÙˆÙ‡ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯ âœ…'))
    .catch(err => alert('Ù¾ÛŒØ§Ù… ØªÙ„Ú¯Ø±Ø§Ù… Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ø¯: ' + err));

  // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù…
  document.getElementById('name').value = '';
  document.getElementById('text').value = '';
  document.getElementById('source').value = '';
  document.getElementById('category').value = '';
  document.getElementById('description').value = '';
}
</script>

</body>
</html>
